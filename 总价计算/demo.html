<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>总价计算</title>
</head>
<body>
<form action="" id="form">
	<label for="all"><input type="checkbox" name="" id="all">全选</label>
	<hr>
	<label for="smoke"><p><input type="checkbox" name="" id="smoke"> 中华烟：￥<span>45</span></p></label>
	<label for="wine"><p><input type="checkbox" name="" id="wine"> 茅台酒：￥<span>888.88</span></p></label>
	<label for="tea"><p><input type="checkbox" name="" id="tea"> 普洱茶：￥<span>666.66</span></p></label>
	<label for="ht"><p><input type="checkbox" name="" id="ht"> 大核桃：￥<span>19.99</span></p></label>
	<p>总价：￥<input type="text" id="totalPrice" readonly name="total" value="0.00"></p>
</form>
	<script>
		var ipts = form.querySelectorAll("input[type=checkbox]:not(#all)");
		NodeList.prototype.every = Array.prototype.every;
		form.onclick = function(evt){
			var e = evt || window.event;
			var target = e.target || e.srcElement;
			var price = totalPrice.value*1;
			if(target.type == "checkbox"){
				if(target.nextElementSibling){
					// if(target.checked){
					// 	price += target.nextElementSibling.innerText*1;
					// }else{
					// 	price -= target.nextElementSibling.innerText*1;
					// }
					price += target.checked ? target.nextElementSibling.innerText*1 : -target.nextElementSibling.innerText*1;
					all.checked = ipts.every(function(ipt){
						return ipt.checked;
					});
					totalPrice.value = price.toFixed(2);
				}
				if(target.id == "all"){
					for(var i=0;i<ipts.length;i++){
						ipts[i].checked = all.checked;
						price = all.checked ? price + ipts[i].nextElementSibling.innerText*1 : 0;
						// if(all.checked){
						// 	price += ipts[i].nextElementSibling.innerText*1
						// }else{
						// 	price = 0;
						// }
					}
					totalPrice.value = price.toFixed(2);
				}
			}
		}


	</script>
</body>
</html>